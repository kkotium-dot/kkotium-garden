// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String?
  level     Int       @default(1)
  exp       Int       @default(0)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  products  Product[]
}

model Supplier {
  id          String    @id @default(cuid())
  name        String
  code        String    @unique
  contact     String?
  address     String?
  description String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  products    Product[]
}

model Product {
  id                      String    @id @default(cuid())

  // ë„¤ì´ë²„ SEO í•„ë“œ (27ê°œ)
  naver_title             String?
  naver_keywords          String?
  naver_description       String?
  naver_brand             String?
  naver_manufacturer      String?
  naver_origin            String?
  naver_material          String?
  naver_color             String?
  naver_size              String?
  naver_weight            String?
  naver_care_instructions String?
  naver_warranty          String?
  naver_certification     String?
  naver_tax_type          String?
  naver_gift_wrapping     Boolean   @default(false)
  naver_as_info           String?
  naver_delivery_info     String?
  naver_exchange_info     String?
  naver_refund_info       String?
  naver_min_order         String?
  naver_max_order         String?
  naver_adult_only        Boolean   @default(false)
  naver_parallel_import   Boolean   @default(false)
  naver_custom_option_1   String?
  naver_custom_option_2   String?
  naver_custom_option_3   String?
  naver_meta_tags         String?

  // ê¸°ì¡´ SEO í•„ë“œ
  seo_title               String?
  seo_keywords            String?
  seo_description         String?

  // íƒ€ì„ìŠ¤íƒ¬í”„
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt

  // ì¶”ê°€ ì´ë¯¸ì§€ ë° AI ê´€ë ¨
  additionalImages        Json?
  aiGeneratedDesc         String?
  aiGeneratedTags         Json?
  aiGeneratedTitle        String?
  aiScore                 Int?

  // ìƒí’ˆ ê¸°ë³¸ ì •ë³´
  asInfo                  String    @default("í‰ì¼ 10:00~18:00")
  asPhone                 String    @default("ê³ ê°ì„¼í„° ë¬¸ì˜")
  barcode                 String?
  brand                   String    @default("ê½ƒí‹”ì›€")
  category                String?
  courierCode             String    @default("CJGLS")
  description             String?

  // ë°°ì†¡ ê´€ë ¨
  exchangeShippingFee     Int       @default(6000)
  freeShippingMinPrice    Int       @default(30000)
  freeShippingThreshold   Int?
  shippingFee             Int       @default(3000)
  shippingMethod          String    @default("íƒë°°ë°°ì†¡")
  shippingPayType         String    @default("ì„ ê²°ì œ")
  shippingStrategy        String    @default("ë¬´ë£Œë°°ì†¡")
  shippingType            String    @default("ì¼ë°˜ë°°ì†¡")
  returnShippingFee       Int       @default(3000)
  supplierReturnFee       Int       @default(0)
  supplierShippingFee     Int       @default(3000)

  // ì˜µì…˜ ê´€ë ¨
  hasOptions              Boolean   @default(false)
  optionName              String?
  optionType              String?
  optionValues            Json?
  options                 Json?

  // ê¸°íƒ€
  hookPhrase              String?
  internalNote            String?
  internalTags            Json?
  keywords                Json?
  lastSaleDate            DateTime?

  // â­ ì´ë¯¸ì§€ í•„ë“œ (ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ 2026 ê¸°ì¤€ - ê°œì„ ë¨)
  mainImage               String?
  images                  String[]  @default([])
  imageAltTexts           String[]  @default([])      // ğŸ†• SEOìš© alt í…ìŠ¤íŠ¸ ë°°ì—´
  imageCount              Int       @default(0)        // ğŸ†• ì´ ì´ë¯¸ì§€ ê°œìˆ˜ (ìºì‹œ)

  manufacturer            String    @default("ë„ë§¤ë§¤ ê³µê¸‰ì‚¬")
  margin                  Float
  minorPurchase           String    @default("Y")
  name                    String
  naverCategoryCode       String    @default("50003307")
  naverProductId          String?
  originCode              String    @default("0001")
  productInfoManufacturer String?
  productInfoModel        String?
  productInfoName         String?
  productStatus           String    @default("ì‹ ìƒí’ˆ")
  salesCount              Int       @default(0)
  salePrice               Int
  sellerCode              String?
  seoTitle                String?
  sku                     String    @unique
  status                  String    @default("DRAFT")
  supplierPrice           Int
  tags                    Json?
  targetKeywords          Json?
  taxType                 String    @default("ê³¼ì„¸")
  vendorCode              String?

  // â­â­â­ ë„¤ì´ë²„ í†µí•© ì„¤ê³„ ì‹ ê·œ í•„ë“œ (2ê°œ ì¶”ê°€) â­â­â­
  naverExcelData          Json?     // ë„¤ì´ë²„ ì—‘ì…€ 88ê°œ í•„ë“œ ì €ì¥
  kkottiNaverScore        Json?     // ê¼¬ë  AI + ë„¤ì´ë²„ í†µí•© í‰ê°€

  // ê´€ê³„
  supplierId              String
  supplier                Supplier  @relation(fields: [supplierId], references: [id])
  userId                  String
  user                    User      @relation(fields: [userId], references: [id])
  orderItems              OrderItem[]

  @@index([supplierId])
  @@index([userId])
  @@index([status])
  @@index([category])
  @@index([imageCount])
}

model Order {
  id              String      @id @default(cuid())
  orderNumber     String      @unique
  customerName    String
  customerEmail   String
  customerPhone   String
  shippingAddress String
  totalAmount     Int
  status          String      @default("PENDING")
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  orderItems      OrderItem[]
}

model OrderItem {
  id        String   @id @default(cuid())
  quantity  Int
  price     Int
  orderId   String
  order     Order    @relation(fields: [orderId], references: [id])
  productId String
  product   Product  @relation(fields: [productId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([orderId])
  @@index([productId])
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// â­â­â­ ë„¤ì´ë²„ ë§ˆìŠ¤í„° ë°ì´í„° í…Œì´ë¸” 3ê°œ (ì‹ ê·œ) â­â­â­
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

// 1. íƒë°°ì‚¬ ë§ˆìŠ¤í„° (212ê°œ)
model DeliveryCompany {
  id        Int      @id @default(autoincrement())
  code      String   @unique
  name      String
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([code])
  @@index([active])
}

// 2. ë„¤ì´ë²„ ì¹´í…Œê³ ë¦¬ ë§ˆìŠ¤í„° (4,993ê°œ)
model NaverCategory {
  id        Int      @id @default(autoincrement())
  code      String   @unique
  level1    String?
  level2    String?
  level3    String?
  level4    String?
  fullPath  String?
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([code])
  @@index([level1])
  @@index([fullPath])
  @@index([active])
}

// 3. ì›ì‚°ì§€ ë§ˆìŠ¤í„° (518ê°œ)
model OriginCode {
  id        Int      @id @default(autoincrement())
  code      String   @unique
  region    String
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([code])
  @@index([active])
}
